plugins {
    id 'java'
    id 'application'
}

group = 'ru.clevertec'
version = '1.0-SNAPSHOT'

repositories {
    jcenter()
}

dependencies {
    implementation 'com.google.guava:guava:28.0-jre'

    testImplementation 'junit:junit:4.12'
    compile 'junit:junit:4.12'
}

application {
    mainClassName = 'ru.clevertec.Runner'
}

jar{
    manifest{
        attributes 'Main-Class': 'ru.clevertec.Runner'
    }
}

test{
    useJUnitPlatform()
}

class FileDownloader extends DefaultTask {

    @Input
    String sourceUrl

    @OutputFile
    File target

    @TaskAction
    void download() {
        try {
            ant.get(src: sourceUrl, dest: target)
        }
        catch (Exception e) {
            println(e)
        }
    }

}
task downloadCheck(type: FileDownloader){
    sourceUrl = 'https://raw.githubusercontent.com/Siarhei-Kanavalau/StoreReceipt/master/src/out.txt'
    target = new File('src/main/resources/check.txt')
}

jar.dependsOn downloadCheck